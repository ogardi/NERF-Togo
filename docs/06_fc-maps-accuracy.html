<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>4.1.6 Analyse de la précision | _main.utf8</title>
  <meta name="description" content="République Togolaise —<br />
Système Nationale de Surveillance des Forêts</div>" />
  <meta name="generator" content="bookdown 0.17 and GitBook 2.6.7" />

  <meta property="og:title" content="4.1.6 Analyse de la précision | _main.utf8" />
  <meta property="og:type" content="book" />
  <meta property="og:url" content="https://ogardi.github.io/NERF-Togo" />
  <meta property="og:image" content="https://ogardi.github.io/NERF-Togoimages/NERF-Togo.png" />
  
  <meta name="github-repo" content="ogardi/NERF-Togo" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="4.1.6 Analyse de la précision | _main.utf8" />
  
  
  <meta name="twitter:image" content="https://ogardi.github.io/NERF-Togoimages/NERF-Togo.png" />

<meta name="author" content="Oliver Gardi, Fifonsi Dangbo, Sophie Dzigbod, Ditorgue Bakabima" />


<meta name="date" content="2020-03-11" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="05_validate-fc-maps.html"/>
<link rel="next" href="07_analyse-fc-maps.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />











<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="https://github.com/ogardi/NERF-Togo"><b>SNSF Togo</b><br>v 1.0 / en développement</a></li>
<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Préface</a></li>
<li class="chapter" data-level="1" data-path="00_introduction.html"><a href="00_introduction.html"><i class="fa fa-check"></i><b>1</b> Introduction</a><ul>
<li class="chapter" data-level="1.1" data-path="01_arrangements.html"><a href="01_arrangements.html"><i class="fa fa-check"></i><b>1.1</b> Arrangements institutionelles</a></li>
<li class="chapter" data-level="1.2" data-path="02_organisation.html"><a href="02_organisation.html"><i class="fa fa-check"></i><b>1.2</b> Organisation du travail</a><ul>
<li class="chapter" data-level="1.2.1" data-path="02_organisation.html"><a href="02_organisation.html#logiciel-et-serveur"><i class="fa fa-check"></i><b>1.2.1</b> Logiciel et serveur</a></li>
<li class="chapter" data-level="1.2.2" data-path="02_organisation.html"><a href="02_organisation.html#structure-du-repertoire"><i class="fa fa-check"></i><b>1.2.2</b> Structure du répértoire</a></li>
<li class="chapter" data-level="1.2.3" data-path="02_organisation.html"><a href="02_organisation.html#creation-dun-nouveau-projet"><i class="fa fa-check"></i><b>1.2.3</b> Création d’un nouveau projet</a></li>
<li class="chapter" data-level="1.2.4" data-path="02_organisation.html"><a href="02_organisation.html#NRF-set-up.R"><i class="fa fa-check"></i><b>1.2.4</b> Définition des variables</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="00_STSS.html"><a href="00_STSS.html"><i class="fa fa-check"></i><b>2</b> Système de Surveillance Terrestre</a><ul>
<li class="chapter" data-level="2.1" data-path="01_data.html"><a href="01_data.html"><i class="fa fa-check"></i><b>2.1</b> Images satellitaires</a><ul>
<li class="chapter" data-level="2.1.1" data-path="01_data.html"><a href="01_data.html#acquisition-des-images"><i class="fa fa-check"></i><b>2.1.1</b> Acquisition des images</a></li>
<li class="chapter" data-level="2.1.2" data-path="01_data.html"><a href="01_data.html#pretraitement-des-images"><i class="fa fa-check"></i><b>2.1.2</b> Prétraitement des images</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="02_sampling-plan.html"><a href="02_sampling-plan.html"><i class="fa fa-check"></i><b>2.2</b> Réseau d’échantillonnage</a></li>
<li class="chapter" data-level="2.3" data-path="02_sampling-plan.html"><a href="02_sampling-plan.html#attributs-enregistres"><i class="fa fa-check"></i><b>2.3</b> Attributs enregistrés</a><ul>
<li class="chapter" data-level="2.3.1" data-path="02_sampling-plan.html"><a href="02_sampling-plan.html#SSTS-couverture-houppiers"><i class="fa fa-check"></i><b>2.3.1</b> Couverture des houppiers</a></li>
<li class="chapter" data-level="2.3.2" data-path="02_sampling-plan.html"><a href="02_sampling-plan.html#SSTS-occupation-terres"><i class="fa fa-check"></i><b>2.3.2</b> Occupation des terres</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="02_sampling-plan.html"><a href="02_sampling-plan.html#mise-en-oeuvre-du-ssts"><i class="fa fa-check"></i><b>2.4</b> Mise en oeuvre du SSTS</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="00_IFN.html"><a href="00_IFN.html"><i class="fa fa-check"></i><b>3</b> Inventaire Forestier National</a></li>
<li class="chapter" data-level="4" data-path="00_NERF-MRV.html"><a href="00_NERF-MRV.html"><i class="fa fa-check"></i><b>4</b> Analyses NRF/MRV</a><ul>
<li class="chapter" data-level="4.1" data-path="00_analyse-FCC.html"><a href="00_analyse-FCC.html"><i class="fa fa-check"></i><b>4.1</b> Analyse surfaces forestiers</a><ul>
<li class="chapter" data-level="4.1.1" data-path="01_create-train-points.html"><a href="01_create-train-points.html"><i class="fa fa-check"></i><b>4.1.1</b> Parcelles d’entraînement</a></li>
<li class="chapter" data-level="4.1.2" data-path="02_create-fc-maps.html"><a href="02_create-fc-maps.html"><i class="fa fa-check"></i><b>4.1.2</b> Calibration et classification</a></li>
<li class="chapter" data-level="4.1.3" data-path="03_clean-fc-maps.html"><a href="03_clean-fc-maps.html"><i class="fa fa-check"></i><b>4.1.3</b> Nettoyage des cartes brutes</a></li>
<li class="chapter" data-level="4.1.4" data-path="04_create-val-points.html"><a href="04_create-val-points.html"><i class="fa fa-check"></i><b>4.1.4</b> Parcelles de validation</a></li>
<li class="chapter" data-level="4.1.5" data-path="05_validate-fc-maps.html"><a href="05_validate-fc-maps.html"><i class="fa fa-check"></i><b>4.1.5</b> Validation des cartes</a></li>
<li class="chapter" data-level="4.1.6" data-path="06_fc-maps-accuracy.html"><a href="06_fc-maps-accuracy.html"><i class="fa fa-check"></i><b>4.1.6</b> Analyse de la précision</a></li>
<li class="chapter" data-level="4.1.7" data-path="07_analyse-fc-maps.html"><a href="07_analyse-fc-maps.html"><i class="fa fa-check"></i><b>4.1.7</b> Production des résultats</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="00_analyse-AGB.html"><a href="00_analyse-AGB.html"><i class="fa fa-check"></i><b>4.2</b> Analyse biomasse aérienne</a><ul>
<li class="chapter" data-level="4.2.1" data-path="01_compile-IFN.html"><a href="01_compile-IFN.html"><i class="fa fa-check"></i><b>4.2.1</b> Analyse des données IFN</a></li>
<li class="chapter" data-level="4.2.2" data-path="02_create-AGB-maps.html"><a href="02_create-AGB-maps.html"><i class="fa fa-check"></i><b>4.2.2</b> Calibration et prédiction</a></li>
<li class="chapter" data-level="4.2.3" data-path="03_clean-AGB-maps.html"><a href="03_clean-AGB-maps.html"><i class="fa fa-check"></i><b>4.2.3</b> Nettoyage des cartes brutes</a></li>
<li class="chapter" data-level="4.2.4" data-path="04_analyze-AGB.html"><a href="04_analyze-AGB.html"><i class="fa fa-check"></i><b>4.2.4</b> Production des résultats</a></li>
</ul></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown">Fièrement publié avec bookdown</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./"><div class="line-block">République Togolaise —<br />
Système Nationale de Surveillance des Forêts</div></a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="analyse-de-la-precision" class="section level3">
<h3><span class="header-section-number">4.1.6</span> Analyse de la précision</h3>
<div id="description-7" class="section level4 unnumbered">
<h4>Description</h4>
<p>Description de la méthodologie / script</p>
</div>
<div id="fcc7_fc-maps-accuracy.r" class="section level4 unnumbered">
<h4><em>FCC/7_fc-maps-accuracy.R</em></h4>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb13-1" data-line-number="1"><span class="co">##########################################################################</span></a>
<a class="sourceLine" id="cb13-2" data-line-number="2"><span class="co"># NERF_Togo/FCC/7_fc-maps-accuracy.R: validate clean forest cover maps</span></a>
<a class="sourceLine" id="cb13-3" data-line-number="3"><span class="co"># ------------------------------------------------------------------------</span></a>
<a class="sourceLine" id="cb13-4" data-line-number="4"><span class="co"># Bern University of Applied Sciences</span></a>
<a class="sourceLine" id="cb13-5" data-line-number="5"><span class="co"># Oliver Gardi, &lt;oliver.gardi@bfh.ch&gt;</span></a>
<a class="sourceLine" id="cb13-6" data-line-number="6"><span class="co"># 20 May 2019</span></a>
<a class="sourceLine" id="cb13-7" data-line-number="7"></a>
<a class="sourceLine" id="cb13-8" data-line-number="8"><span class="co"># based on OpenForis implementation of Olofsson et al. (2014), written by</span></a>
<a class="sourceLine" id="cb13-9" data-line-number="9"><span class="co"># Antonia Ortmann, 20 October, 2014</span></a>
<a class="sourceLine" id="cb13-10" data-line-number="10"><span class="co"># Source: https://github.com/openforis/accuracy-assessment/blob/master/Rscripts/error_matrix_analysis.R</span></a>
<a class="sourceLine" id="cb13-11" data-line-number="11"></a>
<a class="sourceLine" id="cb13-12" data-line-number="12">VALSET &lt;-<span class="st"> &quot;FC30_flex&quot;</span></a>
<a class="sourceLine" id="cb13-13" data-line-number="13"></a>
<a class="sourceLine" id="cb13-14" data-line-number="14"><span class="co"># Function for estimating accuracies ----------------------------------</span></a>
<a class="sourceLine" id="cb13-15" data-line-number="15">  </a>
<a class="sourceLine" id="cb13-16" data-line-number="16">accuracy.estimate &lt;-<span class="st"> </span><span class="cf">function</span>(areas.map, error.matrix, <span class="dt">filename=</span><span class="ot">NULL</span>, <span class="dt">pixelsize=</span><span class="dv">30</span><span class="op">^</span><span class="dv">2</span><span class="op">/</span><span class="dv">10000</span>) {</a>
<a class="sourceLine" id="cb13-17" data-line-number="17">  </a>
<a class="sourceLine" id="cb13-18" data-line-number="18">  <span class="co"># remove &quot;x&quot; from the category </span></a>
<a class="sourceLine" id="cb13-19" data-line-number="19">  <span class="kw">colnames</span>(error.matrix) &lt;-<span class="st"> </span><span class="kw">rownames</span>(error.matrix) &lt;-<span class="st"> </span><span class="kw">gsub</span>(<span class="st">&quot;x&quot;</span>, <span class="st">&quot;&quot;</span>, <span class="kw">colnames</span>(error.matrix))</a>
<a class="sourceLine" id="cb13-20" data-line-number="20">  </a>
<a class="sourceLine" id="cb13-21" data-line-number="21">  <span class="co"># match category order</span></a>
<a class="sourceLine" id="cb13-22" data-line-number="22">  maparea         &lt;-<span class="st"> </span>areas.map[<span class="kw">match</span>(<span class="kw">rownames</span>(error.matrix), <span class="kw">names</span>(areas.map))]</a>
<a class="sourceLine" id="cb13-23" data-line-number="23">  ma              &lt;-<span class="st"> </span>error.matrix</a>
<a class="sourceLine" id="cb13-24" data-line-number="24">  dyn             &lt;-<span class="st"> </span><span class="kw">names</span>(maparea)</a>
<a class="sourceLine" id="cb13-25" data-line-number="25">  </a>
<a class="sourceLine" id="cb13-26" data-line-number="26">  <span class="co"># calculate the area proportions for each map class</span></a>
<a class="sourceLine" id="cb13-27" data-line-number="27">  aoi &lt;-<span class="st"> </span><span class="kw">sum</span>(maparea)</a>
<a class="sourceLine" id="cb13-28" data-line-number="28">  propmaparea &lt;-<span class="st"> </span>maparea<span class="op">/</span>aoi</a>
<a class="sourceLine" id="cb13-29" data-line-number="29">  </a>
<a class="sourceLine" id="cb13-30" data-line-number="30">  <span class="co"># convert the absolute cross tab into a probability cross tab</span></a>
<a class="sourceLine" id="cb13-31" data-line-number="31">  ni. &lt;-<span class="st"> </span><span class="kw">rowSums</span>(ma)                  <span class="co"># number of reference points per map class</span></a>
<a class="sourceLine" id="cb13-32" data-line-number="32">  propma &lt;-<span class="st">  </span><span class="kw">as.matrix</span>(ma<span class="op">/</span>ni. <span class="op">*</span><span class="st"> </span><span class="kw">as.vector</span>(propmaparea))</a>
<a class="sourceLine" id="cb13-33" data-line-number="33">  propma[<span class="kw">is.nan</span>(propma)] &lt;-<span class="st"> </span><span class="dv">0</span>          <span class="co"># for classes with ni. = 0</span></a>
<a class="sourceLine" id="cb13-34" data-line-number="34">  </a>
<a class="sourceLine" id="cb13-35" data-line-number="35">  <span class="co"># estimate the accuracies now</span></a>
<a class="sourceLine" id="cb13-36" data-line-number="36">  OA &lt;-<span class="st"> </span><span class="kw">sum</span>(<span class="kw">diag</span>(propma))              <span class="co"># overall accuracy (Eq. 1 in Olofsson et al. 2014)</span></a>
<a class="sourceLine" id="cb13-37" data-line-number="37">  pe &lt;-<span class="st"> </span><span class="dv">0</span>                              <span class="co"># Agreement by chance ...</span></a>
<a class="sourceLine" id="cb13-38" data-line-number="38">  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(dyn)) {</a>
<a class="sourceLine" id="cb13-39" data-line-number="39">    pe &lt;-<span class="st"> </span>pe <span class="op">+</span><span class="st"> </span><span class="kw">sum</span>(propma[i,]) <span class="op">*</span><span class="st"> </span><span class="kw">sum</span>(propma[,i])</a>
<a class="sourceLine" id="cb13-40" data-line-number="40">  }</a>
<a class="sourceLine" id="cb13-41" data-line-number="41">  K  &lt;-<span class="st"> </span>(OA <span class="op">-</span><span class="st"> </span>pe) <span class="op">/</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span>pe)           <span class="co"># ... for Cohen&#39;s Kappa</span></a>
<a class="sourceLine" id="cb13-42" data-line-number="42">  UA &lt;-<span class="st"> </span><span class="kw">diag</span>(propma) <span class="op">/</span><span class="st"> </span><span class="kw">rowSums</span>(propma) <span class="co"># user&#39;s accuracy (Eq. 2 in Olofsson et al. 2014)</span></a>
<a class="sourceLine" id="cb13-43" data-line-number="43">  PA &lt;-<span class="st"> </span><span class="kw">diag</span>(propma) <span class="op">/</span><span class="st"> </span><span class="kw">colSums</span>(propma) <span class="co"># producer&#39;s accuracy (Eq. 3 in Olofsson et al. 2014)</span></a>
<a class="sourceLine" id="cb13-44" data-line-number="44">  </a>
<a class="sourceLine" id="cb13-45" data-line-number="45">  <span class="co"># estimate confidence intervals for the accuracies</span></a>
<a class="sourceLine" id="cb13-46" data-line-number="46">  V_OA &lt;-<span class="st"> </span><span class="kw">sum</span>(<span class="kw">as.vector</span>(propmaparea)<span class="op">^</span><span class="dv">2</span> <span class="op">*</span><span class="st"> </span>UA <span class="op">*</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span>UA) <span class="op">/</span><span class="st"> </span>(ni. <span class="op">-</span><span class="st"> </span><span class="dv">1</span>), <span class="dt">na.rm=</span>T)  <span class="co"># variance of overall accuracy (Eq. 5 in Olofsson et al. 2014)</span></a>
<a class="sourceLine" id="cb13-47" data-line-number="47">  V_UA &lt;-<span class="st"> </span>UA <span class="op">*</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span>UA) <span class="op">/</span><span class="st"> </span>(<span class="kw">rowSums</span>(ma) <span class="op">-</span><span class="st"> </span><span class="dv">1</span>) <span class="co"># variance of user&#39;s accuracy (Eq. 6 in Olofsson et al. 2014)</span></a>
<a class="sourceLine" id="cb13-48" data-line-number="48">  </a>
<a class="sourceLine" id="cb13-49" data-line-number="49">  <span class="co"># variance of producer&#39;s accuracy (Eq. 7 in Olofsson et al. 2014)</span></a>
<a class="sourceLine" id="cb13-50" data-line-number="50">  N.j &lt;-<span class="st"> </span><span class="kw">array</span>(<span class="dv">0</span>, <span class="dt">dim=</span><span class="kw">length</span>(dyn))</a>
<a class="sourceLine" id="cb13-51" data-line-number="51">  aftersumsign &lt;-<span class="st"> </span><span class="kw">array</span>(<span class="dv">0</span>, <span class="dt">dim=</span><span class="kw">length</span>(dyn))</a>
<a class="sourceLine" id="cb13-52" data-line-number="52">  <span class="cf">for</span>(cj <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(dyn)) {</a>
<a class="sourceLine" id="cb13-53" data-line-number="53">    N.j[cj] &lt;-<span class="st"> </span><span class="kw">sum</span>(maparea <span class="op">/</span><span class="st"> </span>ni. <span class="op">*</span><span class="st"> </span>ma[, cj], <span class="dt">na.rm=</span>T)</a>
<a class="sourceLine" id="cb13-54" data-line-number="54">    aftersumsign[cj] &lt;-<span class="st"> </span><span class="kw">sum</span>(maparea[<span class="op">-</span>cj]<span class="op">^</span><span class="dv">2</span> <span class="op">*</span><span class="st"> </span>ma[<span class="op">-</span>cj, cj] <span class="op">/</span><span class="st"> </span>ni.[<span class="op">-</span>cj] <span class="op">*</span><span class="st"> </span>( <span class="dv">1</span> <span class="op">-</span><span class="st"> </span>ma[<span class="op">-</span>cj, cj] <span class="op">/</span><span class="st"> </span>ni.[<span class="op">-</span>cj]) <span class="op">/</span><span class="st"> </span>(ni.[<span class="op">-</span>cj] <span class="op">-</span><span class="st"> </span><span class="dv">1</span>), <span class="dt">na.rm =</span> T)</a>
<a class="sourceLine" id="cb13-55" data-line-number="55">  }</a>
<a class="sourceLine" id="cb13-56" data-line-number="56">  V_PA &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">/</span>N.j<span class="op">^</span><span class="dv">2</span> <span class="op">*</span><span class="st"> </span>( </a>
<a class="sourceLine" id="cb13-57" data-line-number="57">    maparea<span class="op">^</span><span class="dv">2</span> <span class="op">*</span><span class="st"> </span>(<span class="dv">1</span><span class="op">-</span>PA)<span class="op">^</span><span class="dv">2</span> <span class="op">*</span><span class="st"> </span>UA <span class="op">*</span><span class="st"> </span>(<span class="dv">1</span><span class="op">-</span>UA) <span class="op">/</span><span class="st"> </span>(ni.<span class="op">-</span><span class="dv">1</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb13-58" data-line-number="58"><span class="st">      </span>PA<span class="op">^</span><span class="dv">2</span> <span class="op">*</span><span class="st"> </span>aftersumsign</a>
<a class="sourceLine" id="cb13-59" data-line-number="59">  ) </a>
<a class="sourceLine" id="cb13-60" data-line-number="60">  V_PA[<span class="kw">is.nan</span>(V_PA)] &lt;-<span class="st"> </span><span class="dv">0</span></a>
<a class="sourceLine" id="cb13-61" data-line-number="61">  </a>
<a class="sourceLine" id="cb13-62" data-line-number="62">  <span class="co"># proportional area estimation</span></a>
<a class="sourceLine" id="cb13-63" data-line-number="63">  propAreaEst &lt;-<span class="st"> </span><span class="kw">colSums</span>(propma)        <span class="co"># proportion of area (Eq. 8 in Olofsson et al. 2014)</span></a>
<a class="sourceLine" id="cb13-64" data-line-number="64">  AreaEst &lt;-<span class="st"> </span>propAreaEst <span class="op">*</span><span class="st"> </span><span class="kw">sum</span>(maparea) <span class="co"># estimated area</span></a>
<a class="sourceLine" id="cb13-65" data-line-number="65">  </a>
<a class="sourceLine" id="cb13-66" data-line-number="66">  <span class="co"># standard errors of the area estimation (Eq. 10 in Olofsson et al. 2014)</span></a>
<a class="sourceLine" id="cb13-67" data-line-number="67">  V_propAreaEst &lt;-<span class="st"> </span><span class="kw">array</span>(<span class="dv">0</span>, <span class="dt">dim=</span><span class="kw">length</span>(dyn))</a>
<a class="sourceLine" id="cb13-68" data-line-number="68">  <span class="cf">for</span> (cj <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(dyn)) {</a>
<a class="sourceLine" id="cb13-69" data-line-number="69">    V_propAreaEst[cj] &lt;-<span class="st"> </span><span class="kw">sum</span>((<span class="kw">as.vector</span>(propmaparea) <span class="op">*</span><span class="st"> </span>propma[, cj] <span class="op">-</span><span class="st"> </span>propma[, cj] <span class="op">^</span><span class="st"> </span><span class="dv">2</span>) <span class="op">/</span><span class="st"> </span>( <span class="kw">rowSums</span>(ma) <span class="op">-</span><span class="st"> </span><span class="dv">1</span>))</a>
<a class="sourceLine" id="cb13-70" data-line-number="70">  }</a>
<a class="sourceLine" id="cb13-71" data-line-number="71">  V_propAreaEst[<span class="kw">is.na</span>(V_propAreaEst)] &lt;-<span class="st"> </span><span class="dv">0</span></a>
<a class="sourceLine" id="cb13-72" data-line-number="72">  </a>
<a class="sourceLine" id="cb13-73" data-line-number="73">  <span class="co"># produce result tables</span></a>
<a class="sourceLine" id="cb13-74" data-line-number="74">  </a>
<a class="sourceLine" id="cb13-75" data-line-number="75">  res &lt;-<span class="st"> </span><span class="kw">list</span>()</a>
<a class="sourceLine" id="cb13-76" data-line-number="76">  res<span class="op">$</span>PREDICTED_PX      &lt;-<span class="st"> </span><span class="kw">as.table</span>(maparea)</a>
<a class="sourceLine" id="cb13-77" data-line-number="77">  res<span class="op">$</span>ERROR_MATRIX      &lt;-<span class="st"> </span>ma</a>
<a class="sourceLine" id="cb13-78" data-line-number="78">  res<span class="op">$</span>ERROR_MATRIX_PROP &lt;-<span class="st"> </span><span class="kw">round</span>(propma, <span class="dv">3</span>)</a>
<a class="sourceLine" id="cb13-79" data-line-number="79">  res<span class="op">$</span>OVERALL_ACC       &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">accuracy=</span><span class="kw">round</span>(<span class="kw">c</span>(OA, K), <span class="dv">3</span>), </a>
<a class="sourceLine" id="cb13-80" data-line-number="80">                                      <span class="dt">CI=</span><span class="kw">round</span>(<span class="kw">c</span>(<span class="fl">1.96</span> <span class="op">*</span><span class="st"> </span><span class="kw">sqrt</span>(V_OA), <span class="ot">NA</span>), <span class="dv">3</span>),</a>
<a class="sourceLine" id="cb13-81" data-line-number="81">                                      <span class="dt">row.names=</span><span class="kw">c</span>(<span class="st">&quot;OA&quot;</span>, <span class="st">&quot;Kappa&quot;</span>))</a>
<a class="sourceLine" id="cb13-82" data-line-number="82">  res<span class="op">$</span>CLASSES_ACC &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">maparea=</span><span class="kw">round</span>(maparea <span class="op">*</span><span class="st"> </span>pixelsize, <span class="dv">3</span>)) <span class="co"># in ha</span></a>
<a class="sourceLine" id="cb13-83" data-line-number="83">  res<span class="op">$</span>CLASSES_ACC<span class="op">$</span>prop_maparea    &lt;-<span class="st"> </span><span class="kw">round</span>(propmaparea, <span class="dv">3</span>)</a>
<a class="sourceLine" id="cb13-84" data-line-number="84">  res<span class="op">$</span>CLASSES_ACC<span class="op">$</span>adj_proparea    &lt;-<span class="st"> </span><span class="kw">round</span>(propAreaEst, <span class="dv">3</span>)</a>
<a class="sourceLine" id="cb13-85" data-line-number="85">  res<span class="op">$</span>CLASSES_ACC<span class="op">$</span>CI_adj_proparea &lt;-<span class="st"> </span><span class="kw">round</span>(<span class="fl">1.96</span> <span class="op">*</span><span class="st"> </span><span class="kw">sqrt</span>(V_propAreaEst), <span class="dv">3</span>)</a>
<a class="sourceLine" id="cb13-86" data-line-number="86">  res<span class="op">$</span>CLASSES_ACC<span class="op">$</span>adj_area        &lt;-<span class="st"> </span><span class="kw">round</span>(propAreaEst <span class="op">*</span><span class="st"> </span>aoi <span class="op">*</span><span class="st"> </span>pixelsize, <span class="dv">3</span>) <span class="co"># in ha</span></a>
<a class="sourceLine" id="cb13-87" data-line-number="87">  res<span class="op">$</span>CLASSES_ACC<span class="op">$</span>CI_adj_area     &lt;-<span class="st"> </span><span class="kw">round</span>(<span class="fl">1.96</span> <span class="op">*</span><span class="st"> </span><span class="kw">sqrt</span>(V_propAreaEst) <span class="op">*</span><span class="st"> </span>aoi <span class="op">*</span><span class="st"> </span>pixelsize, <span class="dv">3</span>) <span class="co"># in ha</span></a>
<a class="sourceLine" id="cb13-88" data-line-number="88">  res<span class="op">$</span>CLASSES_ACC<span class="op">$</span>UA              &lt;-<span class="st"> </span><span class="kw">round</span>(UA, <span class="dv">3</span>)</a>
<a class="sourceLine" id="cb13-89" data-line-number="89">  res<span class="op">$</span>CLASSES_ACC<span class="op">$</span>CI_UA           &lt;-<span class="st"> </span><span class="kw">round</span>(<span class="fl">1.96</span> <span class="op">*</span><span class="st"> </span><span class="kw">sqrt</span>(V_UA), <span class="dv">3</span>)</a>
<a class="sourceLine" id="cb13-90" data-line-number="90">  res<span class="op">$</span>CLASSES_ACC<span class="op">$</span>PA              &lt;-<span class="st"> </span><span class="kw">round</span>(PA, <span class="dv">3</span>)</a>
<a class="sourceLine" id="cb13-91" data-line-number="91">  res<span class="op">$</span>CLASSES_ACC<span class="op">$</span>CI_PA           &lt;-<span class="st"> </span><span class="kw">round</span>(<span class="fl">1.96</span> <span class="op">*</span><span class="st"> </span><span class="kw">sqrt</span>(V_PA), <span class="dv">3</span>)</a>
<a class="sourceLine" id="cb13-92" data-line-number="92">  </a>
<a class="sourceLine" id="cb13-93" data-line-number="93">  <span class="co"># write results to Excel File</span></a>
<a class="sourceLine" id="cb13-94" data-line-number="94">  <span class="cf">if</span>(<span class="op">!</span><span class="kw">is.null</span>(filename)) {</a>
<a class="sourceLine" id="cb13-95" data-line-number="95">    <span class="kw">write.xlsx</span>(res,</a>
<a class="sourceLine" id="cb13-96" data-line-number="96">               <span class="dt">file=</span>filename,</a>
<a class="sourceLine" id="cb13-97" data-line-number="97">               <span class="dt">col.names=</span><span class="ot">TRUE</span>, <span class="dt">row.names=</span><span class="ot">TRUE</span>, <span class="dt">overwrite=</span><span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb13-98" data-line-number="98">  }</a>
<a class="sourceLine" id="cb13-99" data-line-number="99">  </a>
<a class="sourceLine" id="cb13-100" data-line-number="100">  <span class="kw">return</span>(res)</a>
<a class="sourceLine" id="cb13-101" data-line-number="101">  </a>
<a class="sourceLine" id="cb13-102" data-line-number="102">}</a>
<a class="sourceLine" id="cb13-103" data-line-number="103"></a>
<a class="sourceLine" id="cb13-104" data-line-number="104"></a>
<a class="sourceLine" id="cb13-105" data-line-number="105"><span class="co"># DO THE WORK ----------------------------------</span></a>
<a class="sourceLine" id="cb13-106" data-line-number="106"></a>
<a class="sourceLine" id="cb13-107" data-line-number="107"><span class="co"># load the error matrices (R object ct)</span></a>
<a class="sourceLine" id="cb13-108" data-line-number="108"><span class="kw">load</span>(<span class="kw">paste0</span>(FCC.VAL.DIR, <span class="st">&quot;/ConfTab_&quot;</span>, VALSET, <span class="st">&quot;.RData&quot;</span>))</a>
<a class="sourceLine" id="cb13-109" data-line-number="109"></a>
<a class="sourceLine" id="cb13-110" data-line-number="110"><span class="co"># load the predictions and convert &quot;potential regeneration (2)&quot; to &quot;non-forest (3)&quot;</span></a>
<a class="sourceLine" id="cb13-111" data-line-number="111">fc<span class="fl">.2003</span> &lt;-<span class="st"> </span><span class="kw">brick</span>(<span class="kw">paste0</span>(FCC.CLN.DIR, <span class="st">&quot;/FC30/TGO/TGO_2003_F30cf.tif&quot;</span>)); fc<span class="fl">.2003</span>[fc<span class="fl">.2003</span><span class="op">==</span><span class="dv">2</span>] &lt;-<span class="st"> </span><span class="dv">3</span></a>
<a class="sourceLine" id="cb13-112" data-line-number="112">fc<span class="fl">.2015</span> &lt;-<span class="st"> </span><span class="kw">brick</span>(<span class="kw">paste0</span>(FCC.CLN.DIR, <span class="st">&quot;/FC30/TGO/TGO_2015_F30cf.tif&quot;</span>)); fc<span class="fl">.2015</span>[fc<span class="fl">.2015</span><span class="op">==</span><span class="dv">2</span>] &lt;-<span class="st"> </span><span class="dv">3</span></a>
<a class="sourceLine" id="cb13-113" data-line-number="113">fc<span class="fl">.2018</span> &lt;-<span class="st"> </span><span class="kw">brick</span>(<span class="kw">paste0</span>(FCC.CLN.DIR, <span class="st">&quot;/FC30/TGO/TGO_2018_F30cf.tif&quot;</span>)); fc<span class="fl">.2018</span>[fc<span class="fl">.2018</span><span class="op">==</span><span class="dv">2</span>] &lt;-<span class="st"> </span><span class="dv">3</span></a>
<a class="sourceLine" id="cb13-114" data-line-number="114"></a>
<a class="sourceLine" id="cb13-115" data-line-number="115"><span class="co"># create 3-date transition map </span></a>
<a class="sourceLine" id="cb13-116" data-line-number="116">fcc  &lt;-<span class="st">  </span><span class="dv">100</span> <span class="op">*</span><span class="st"> </span>fc<span class="fl">.2003</span> <span class="op">+</span><span class="st"> </span><span class="dv">10</span> <span class="op">*</span><span class="st"> </span>fc<span class="fl">.2015</span> <span class="op">+</span><span class="st"> </span><span class="dv">1</span> <span class="op">*</span><span class="st"> </span>fc<span class="fl">.2018</span></a>
<a class="sourceLine" id="cb13-117" data-line-number="117"></a>
<a class="sourceLine" id="cb13-118" data-line-number="118"><span class="co"># get pixel counts (takes time) and separate for different dates / transitions</span></a>
<a class="sourceLine" id="cb13-119" data-line-number="119">freq &lt;-<span class="st"> </span><span class="kw">table</span>(fcc[])</a>
<a class="sourceLine" id="cb13-120" data-line-number="120">tmp &lt;-<span class="st"> </span><span class="kw">as.numeric</span>(freq); <span class="kw">names</span>(tmp) &lt;-<span class="st"> </span><span class="kw">names</span>(freq); freq &lt;-<span class="st"> </span>tmp</a>
<a class="sourceLine" id="cb13-121" data-line-number="121"></a>
<a class="sourceLine" id="cb13-122" data-line-number="122">freq.<span class="dv">03</span>.<span class="fl">15.18</span>        &lt;-<span class="st"> </span><span class="kw">c</span>(freq[<span class="st">&quot;111&quot;</span>], freq[<span class="st">&quot;113&quot;</span>], freq[<span class="st">&quot;131&quot;</span>], freq[<span class="st">&quot;133&quot;</span>], freq[<span class="st">&quot;311&quot;</span>], freq[<span class="st">&quot;313&quot;</span>], freq[<span class="st">&quot;331&quot;</span>], freq[<span class="st">&quot;333&quot;</span>])</a>
<a class="sourceLine" id="cb13-123" data-line-number="123"><span class="kw">names</span>(freq.<span class="dv">03</span>.<span class="fl">15.18</span>) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;111&quot;</span>, <span class="st">&quot;113&quot;</span>, <span class="st">&quot;131&quot;</span>, <span class="st">&quot;133&quot;</span>, <span class="st">&quot;311&quot;</span>, <span class="st">&quot;313&quot;</span>, <span class="st">&quot;331&quot;</span>, <span class="st">&quot;333&quot;</span>); freq.<span class="dv">03</span>.<span class="fl">15.18</span>[<span class="kw">is.na</span>(freq.<span class="dv">03</span>.<span class="fl">15.18</span>)] &lt;-<span class="st"> </span><span class="dv">0</span></a>
<a class="sourceLine" id="cb13-124" data-line-number="124"></a>
<a class="sourceLine" id="cb13-125" data-line-number="125">freq.<span class="fl">03.18</span>        &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">sum</span>(freq[<span class="st">&quot;111&quot;</span>],freq[<span class="st">&quot;131&quot;</span>], <span class="dt">na.rm=</span>T), <span class="kw">sum</span>(freq[<span class="st">&quot;113&quot;</span>],freq[<span class="st">&quot;133&quot;</span>], <span class="dt">na.rm=</span>T),</a>
<a class="sourceLine" id="cb13-126" data-line-number="126">                       <span class="kw">sum</span>(freq[<span class="st">&quot;311&quot;</span>],freq[<span class="st">&quot;331&quot;</span>], <span class="dt">na.rm=</span>T), <span class="kw">sum</span>(freq[<span class="st">&quot;313&quot;</span>],freq[<span class="st">&quot;333&quot;</span>], <span class="dt">na.rm=</span>T))</a>
<a class="sourceLine" id="cb13-127" data-line-number="127"><span class="kw">names</span>(freq.<span class="fl">03.18</span>) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;11&quot;</span>, <span class="st">&quot;13&quot;</span>, <span class="st">&quot;31&quot;</span>, <span class="st">&quot;33&quot;</span>); freq.<span class="fl">03.18</span>[<span class="kw">is.na</span>(freq.<span class="fl">03.18</span>)] &lt;-<span class="st"> </span><span class="dv">0</span></a>
<a class="sourceLine" id="cb13-128" data-line-number="128"></a>
<a class="sourceLine" id="cb13-129" data-line-number="129">freq.<span class="fl">03.15</span>        &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">sum</span>(freq[<span class="st">&quot;111&quot;</span>],freq[<span class="st">&quot;113&quot;</span>], <span class="dt">na.rm=</span>T), <span class="kw">sum</span>(freq[<span class="st">&quot;131&quot;</span>],freq[<span class="st">&quot;133&quot;</span>], <span class="dt">na.rm=</span>T),</a>
<a class="sourceLine" id="cb13-130" data-line-number="130">                       <span class="kw">sum</span>(freq[<span class="st">&quot;311&quot;</span>],freq[<span class="st">&quot;313&quot;</span>], <span class="dt">na.rm=</span>T), <span class="kw">sum</span>(freq[<span class="st">&quot;331&quot;</span>],freq[<span class="st">&quot;333&quot;</span>], <span class="dt">na.rm=</span>T))</a>
<a class="sourceLine" id="cb13-131" data-line-number="131"><span class="kw">names</span>(freq.<span class="fl">03.15</span>) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;11&quot;</span>, <span class="st">&quot;13&quot;</span>, <span class="st">&quot;31&quot;</span>, <span class="st">&quot;33&quot;</span>); freq.<span class="fl">03.15</span>[<span class="kw">is.na</span>(freq.<span class="fl">03.15</span>)] &lt;-<span class="st"> </span><span class="dv">0</span></a>
<a class="sourceLine" id="cb13-132" data-line-number="132"></a>
<a class="sourceLine" id="cb13-133" data-line-number="133">freq.<span class="fl">15.18</span>        &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">sum</span>(freq[<span class="st">&quot;111&quot;</span>],freq[<span class="st">&quot;311&quot;</span>], <span class="dt">na.rm=</span>T), <span class="kw">sum</span>(freq[<span class="st">&quot;113&quot;</span>],freq[<span class="st">&quot;313&quot;</span>], <span class="dt">na.rm=</span>T),</a>
<a class="sourceLine" id="cb13-134" data-line-number="134">                       <span class="kw">sum</span>(freq[<span class="st">&quot;131&quot;</span>],freq[<span class="st">&quot;331&quot;</span>], <span class="dt">na.rm=</span>T), <span class="kw">sum</span>(freq[<span class="st">&quot;133&quot;</span>],freq[<span class="st">&quot;333&quot;</span>], <span class="dt">na.rm=</span>T))</a>
<a class="sourceLine" id="cb13-135" data-line-number="135"><span class="kw">names</span>(freq.<span class="fl">15.18</span>) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;11&quot;</span>, <span class="st">&quot;13&quot;</span>, <span class="st">&quot;31&quot;</span>, <span class="st">&quot;33&quot;</span>); freq.<span class="fl">15.18</span>[<span class="kw">is.na</span>(freq.<span class="fl">15.18</span>)] &lt;-<span class="st"> </span><span class="dv">0</span></a>
<a class="sourceLine" id="cb13-136" data-line-number="136"></a>
<a class="sourceLine" id="cb13-137" data-line-number="137">freq<span class="fl">.03</span>           &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">sum</span>(freq[<span class="st">&quot;111&quot;</span>],freq[<span class="st">&quot;131&quot;</span>], freq[<span class="st">&quot;113&quot;</span>],freq[<span class="st">&quot;133&quot;</span>], <span class="dt">na.rm=</span>T),</a>
<a class="sourceLine" id="cb13-138" data-line-number="138">                       <span class="kw">sum</span>(freq[<span class="st">&quot;311&quot;</span>],freq[<span class="st">&quot;331&quot;</span>], freq[<span class="st">&quot;313&quot;</span>],freq[<span class="st">&quot;333&quot;</span>], <span class="dt">na.rm=</span>T))</a>
<a class="sourceLine" id="cb13-139" data-line-number="139"><span class="kw">names</span>(freq<span class="fl">.03</span>)    &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;1&quot;</span>, <span class="st">&quot;3&quot;</span>); freq<span class="fl">.03</span>[<span class="kw">is.na</span>(freq<span class="fl">.03</span>)] &lt;-<span class="st"> </span><span class="dv">0</span></a>
<a class="sourceLine" id="cb13-140" data-line-number="140">  </a>
<a class="sourceLine" id="cb13-141" data-line-number="141">freq<span class="fl">.15</span>           &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">sum</span>(freq[<span class="st">&quot;111&quot;</span>],freq[<span class="st">&quot;311&quot;</span>], freq[<span class="st">&quot;113&quot;</span>],freq[<span class="st">&quot;313&quot;</span>], <span class="dt">na.rm=</span>T),</a>
<a class="sourceLine" id="cb13-142" data-line-number="142">                       <span class="kw">sum</span>(freq[<span class="st">&quot;131&quot;</span>],freq[<span class="st">&quot;331&quot;</span>], freq[<span class="st">&quot;133&quot;</span>],freq[<span class="st">&quot;333&quot;</span>], <span class="dt">na.rm=</span>T))</a>
<a class="sourceLine" id="cb13-143" data-line-number="143"><span class="kw">names</span>(freq<span class="fl">.15</span>)    &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;1&quot;</span>, <span class="st">&quot;3&quot;</span>); freq<span class="fl">.15</span>[<span class="kw">is.na</span>(freq<span class="fl">.15</span>)] &lt;-<span class="st"> </span><span class="dv">0</span></a>
<a class="sourceLine" id="cb13-144" data-line-number="144"></a>
<a class="sourceLine" id="cb13-145" data-line-number="145">freq<span class="fl">.18</span>           &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">sum</span>(freq[<span class="st">&quot;111&quot;</span>],freq[<span class="st">&quot;311&quot;</span>], freq[<span class="st">&quot;131&quot;</span>],freq[<span class="st">&quot;331&quot;</span>], <span class="dt">na.rm=</span>T),</a>
<a class="sourceLine" id="cb13-146" data-line-number="146">                       <span class="kw">sum</span>(freq[<span class="st">&quot;113&quot;</span>],freq[<span class="st">&quot;313&quot;</span>], freq[<span class="st">&quot;133&quot;</span>],freq[<span class="st">&quot;333&quot;</span>], <span class="dt">na.rm=</span>T))</a>
<a class="sourceLine" id="cb13-147" data-line-number="147"><span class="kw">names</span>(freq<span class="fl">.18</span>)    &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;1&quot;</span>, <span class="st">&quot;3&quot;</span>); freq<span class="fl">.18</span>[<span class="kw">is.na</span>(freq<span class="fl">.18</span>)] &lt;-<span class="st"> </span><span class="dv">0</span></a>
<a class="sourceLine" id="cb13-148" data-line-number="148"></a>
<a class="sourceLine" id="cb13-149" data-line-number="149"><span class="co"># create accuracy maps ------------------------------------</span></a>
<a class="sourceLine" id="cb13-150" data-line-number="150"></a>
<a class="sourceLine" id="cb13-151" data-line-number="151"><span class="kw">accuracy.estimate</span>(freq<span class="fl">.18</span>, ct<span class="op">$</span>MAP_VAL<span class="fl">.18</span>c<span class="op">$</span>table , <span class="dt">filename=</span><span class="kw">paste0</span>(FCC.VAL.DIR, <span class="st">&quot;/&quot;</span>, VALSET, <span class="st">&quot;_Acc_18.xlsx&quot;</span>))</a>
<a class="sourceLine" id="cb13-152" data-line-number="152"><span class="kw">accuracy.estimate</span>(freq<span class="fl">.15</span>, ct<span class="op">$</span>MAP_VAL<span class="fl">.15</span>c<span class="op">$</span>table , <span class="dt">filename=</span><span class="kw">paste0</span>(FCC.VAL.DIR, <span class="st">&quot;/&quot;</span>, VALSET, <span class="st">&quot;_Acc_15.xlsx&quot;</span>))</a>
<a class="sourceLine" id="cb13-153" data-line-number="153"><span class="kw">accuracy.estimate</span>(freq<span class="fl">.03</span>, ct<span class="op">$</span>MAP_VAL<span class="fl">.03</span>c<span class="op">$</span>table , <span class="dt">filename=</span><span class="kw">paste0</span>(FCC.VAL.DIR, <span class="st">&quot;/&quot;</span>, VALSET, <span class="st">&quot;_Acc_03.xlsx&quot;</span>))</a>
<a class="sourceLine" id="cb13-154" data-line-number="154"></a>
<a class="sourceLine" id="cb13-155" data-line-number="155"><span class="kw">accuracy.estimate</span>(freq.<span class="fl">03.15</span>, ct<span class="op">$</span>MAP_VAL.<span class="fl">03.15</span>c<span class="op">$</span>table , <span class="dt">filename=</span><span class="kw">paste0</span>(FCC.VAL.DIR, <span class="st">&quot;/&quot;</span>, VALSET, <span class="st">&quot;_Acc_03-15.xlsx&quot;</span>))</a>
<a class="sourceLine" id="cb13-156" data-line-number="156"><span class="kw">accuracy.estimate</span>(freq.<span class="fl">15.18</span>, ct<span class="op">$</span>MAP_VAL.<span class="fl">15.18</span>c<span class="op">$</span>table , <span class="dt">filename=</span><span class="kw">paste0</span>(FCC.VAL.DIR, <span class="st">&quot;/&quot;</span>, VALSET, <span class="st">&quot;_Acc_15-18.xlsx&quot;</span>))</a>
<a class="sourceLine" id="cb13-157" data-line-number="157"><span class="kw">accuracy.estimate</span>(freq.<span class="fl">03.18</span>, ct<span class="op">$</span>MAP_VAL.<span class="fl">03.18</span>c<span class="op">$</span>table , <span class="dt">filename=</span><span class="kw">paste0</span>(FCC.VAL.DIR, <span class="st">&quot;/&quot;</span>, VALSET, <span class="st">&quot;_Acc_03-18.xlsx&quot;</span>))</a>
<a class="sourceLine" id="cb13-158" data-line-number="158"></a>
<a class="sourceLine" id="cb13-159" data-line-number="159"><span class="kw">accuracy.estimate</span>(freq.<span class="dv">03</span>.<span class="fl">15.18</span>, ct<span class="op">$</span>MAP_VAL.<span class="dv">03</span>.<span class="fl">15.18</span>c<span class="op">$</span>table , <span class="dt">filename=</span><span class="kw">paste0</span>(FCC.VAL.DIR, <span class="st">&quot;/&quot;</span>, VALSET, <span class="st">&quot;_Acc_03-15-18.xlsx&quot;</span>))</a>
<a class="sourceLine" id="cb13-160" data-line-number="160"></a>
<a class="sourceLine" id="cb13-161" data-line-number="161"><span class="co"># calculate forest cover, loss and gains ---------------------</span></a>
<a class="sourceLine" id="cb13-162" data-line-number="162"></a>
<a class="sourceLine" id="cb13-163" data-line-number="163">res &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">year     =</span> <span class="kw">c</span>(<span class="dv">2003</span>,         <span class="dv">2015</span>,             <span class="dv">2018</span>),</a>
<a class="sourceLine" id="cb13-164" data-line-number="164">                  <span class="dt">total.ha =</span> <span class="kw">c</span>(freq<span class="fl">.03</span>[<span class="st">&quot;1&quot;</span>], freq<span class="fl">.15</span>[<span class="st">&quot;1&quot;</span>],     freq<span class="fl">.18</span>[<span class="st">&quot;1&quot;</span>])     <span class="op">*</span><span class="st"> </span><span class="dv">30</span><span class="op">^</span><span class="dv">2</span><span class="op">/</span><span class="dv">10000</span>,</a>
<a class="sourceLine" id="cb13-165" data-line-number="165">                  <span class="dt">defor.ha =</span> <span class="kw">c</span>(<span class="ot">NA</span>,           freq.<span class="fl">03.15</span>[<span class="st">&quot;13&quot;</span>], freq.<span class="fl">15.18</span>[<span class="st">&quot;13&quot;</span>]) <span class="op">*</span><span class="st"> </span><span class="dv">30</span><span class="op">^</span><span class="dv">2</span><span class="op">/</span><span class="dv">10000</span>,</a>
<a class="sourceLine" id="cb13-166" data-line-number="166">                  <span class="dt">regen.ha =</span> <span class="kw">c</span>(<span class="ot">NA</span>,           freq.<span class="fl">03.15</span>[<span class="st">&quot;31&quot;</span>], freq.<span class="fl">15.18</span>[<span class="st">&quot;31&quot;</span>]) <span class="op">*</span><span class="st"> </span><span class="dv">30</span><span class="op">^</span><span class="dv">2</span><span class="op">/</span><span class="dv">10000</span>)</a>
<a class="sourceLine" id="cb13-167" data-line-number="167">                  </a>
<a class="sourceLine" id="cb13-168" data-line-number="168"></a>
<a class="sourceLine" id="cb13-169" data-line-number="169"></a>
<a class="sourceLine" id="cb13-170" data-line-number="170"></a>
<a class="sourceLine" id="cb13-171" data-line-number="171"><span class="co"># Example from Olofsson et al. (2014)</span></a>
<a class="sourceLine" id="cb13-172" data-line-number="172"><span class="co"># -----------------------------------</span></a>
<a class="sourceLine" id="cb13-173" data-line-number="173"><span class="co"># ct &lt;- matrix(data=c(66,  0,   5,   4,</span></a>
<a class="sourceLine" id="cb13-174" data-line-number="174"><span class="co">#                     0, 55,   8,  12,</span></a>
<a class="sourceLine" id="cb13-175" data-line-number="175"><span class="co">#                     1,  0, 153,  11,</span></a>
<a class="sourceLine" id="cb13-176" data-line-number="176"><span class="co">#                     2,  1,   9, 313),</span></a>
<a class="sourceLine" id="cb13-177" data-line-number="177"><span class="co">#              nrow=4,</span></a>
<a class="sourceLine" id="cb13-178" data-line-number="178"><span class="co">#              byrow=TRUE,</span></a>
<a class="sourceLine" id="cb13-179" data-line-number="179"><span class="co">#              dimnames = list(Prediction=c(&quot;FN&quot;, &quot;NF&quot;, &quot;FF&quot;, &quot;NN&quot;), Reference=c(&quot;FN&quot;, &quot;NF&quot;, &quot;FF&quot;, &quot;NN&quot;)))</span></a>
<a class="sourceLine" id="cb13-180" data-line-number="180"><span class="co"># </span></a>
<a class="sourceLine" id="cb13-181" data-line-number="181"><span class="co"># px &lt;- c(FN=200000, NF=150000, FF=3200000, NN=6450000)</span></a>
<a class="sourceLine" id="cb13-182" data-line-number="182"><span class="co"># </span></a>
<a class="sourceLine" id="cb13-183" data-line-number="183"><span class="co"># accuracy.estimate(px, ct)</span></a></code></pre></div>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="05_validate-fc-maps.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="07_analyse-fc-maps.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": false,
"twitter": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": null,
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection",
"scroll_highlight": true
},
"toolbar": {
"position": "fixed"
},
"search": true,
"info": true
});
});
</script>

</body>

</html>
